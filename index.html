<style>
    *{
    margin: 0;padding: 0;
    }
  .dropbtn {
    background-color: #3498DB;
    color: white;
    padding: 16px;
    font-size: 16px;
    border: none;
    cursor: pointer;
  }
  .dropbtn:hover, .dropbtn:focus {
    background-color: #2980B9;
  }
  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #f1f1f1;
    min-width: 160px;
    overflow: auto;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
  }
  .dropdown-content .options {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
  }
  .dropdown .options:hover {background-color: #ddd;}
  .show {display: block;}

  .container{
    height: 100%;
    width: 100%;
    background-color: lightcoral;
  }
  .dropdown {
    position: relative;
    height: 50vh;
    width: 35%;
    margin: auto;
    padding: 10vh;
  }
  textarea{
    height: 15%;
    width: 100%;
    font-size: 18px;
    padding: 10px;
  }

  #textarea {
    -moz-appearance: textfield-multiline;
    -webkit-appearance: textarea;
    border: 2px solid #333333;
    font: medium -moz-fixed;
    font: -webkit-small-control;
    height: auto;
    overflow: auto;
    padding: 10px;
    resize: both;
    width: 400px;
    font-size: 18px;
    background: #ffff;
    border-radius: 10px;
  }
  #textarea:focus{
    outline: none;
  }
</style>
    
<!DOCTYPE html>
<html>
<body> 
<div class="container">
  <div class="dropdown">
    <h1>My Mentions</h1>
    <div class="textarea_div" id="textarea" contenteditable type="text" onkeyup="myMention(event)"></div>
  </div>
</div>


<!-- <label for="ice-cream-choice">Choose a flavor:</label>
<input list="ice-cream-flavors" id="ice-cream-choice" name="ice-cream-choice" />

<datalist id="ice-cream-flavors">
  <option value="Chocolate">
  <option value="Coconut">
  <option value="Mint">
  <option value="Strawberry">
  <option value="Vanilla">
</datalist> -->

<script>
function myMention(e) {
  console.log(e.key);
  let textArea = document.getElementById("textarea");
  let matching = textArea.textContent;
  let format = matching.match("@"); 

  if(format != null){
    if(format.length > 0){
      let createDropdown = document.createElement("div");
      createDropdown.id = 'myDropdown';
      createDropdown.classList.add("dropdown-content");
      
      for(let i = 0; i < 6; i++){
        let createOptions = document.createElement("div");
        createOptions.classList.add("options");
        createOptions.innerHTML = "Pardeep";
        createOptions.onclick = function () {
          select_option('Pardeep');
        }
        createDropdown.append(createOptions);
      }
      textArea.append(createDropdown);
      document.getElementById('myDropdown').classList.add("show");
    }
    else{
        document.getElementById('myDropdown').classList.remove("show");
        document.getElementById('myDropdown').remove();
    }
  }
}

function select_option(username){
  let appendMention = document.getElementById("textarea");
  let myDropdown = document.getElementsByClassName("dropdown-content")[0];
  let createSpan = document.createElement('span');
  createSpan.classList.add("span-element");
  createSpan.innerHTML = username;
  console.log("UserName", username);
  console.log("UserName", appendMention);
  appendMention.append(createSpan);

  let currentString = appendMention.childNodes[0].nodeValue;
  let updateString = currentString.toString().replace(/[^a-zA-Z !?]/g, "");
  appendMention.childNodes[0].nodeValue = updateString;
  if(myDropdown){
    myDropdown.classList.remove("show");
    myDropdown.remove();
  }
}
</script>
    
</body>
</html>
    